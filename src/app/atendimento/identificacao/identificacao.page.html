<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
        <ion-back-button></ion-back-button>
    </ion-buttons>

    <ion-title>Dados Básicos</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <form class="form" [formGroup]="form"  (ngSubmit)="salvar(form.value)">
    <ion-grid>
      <ion-row>
        <ion-col   size-xs="12" size-md="12">
          <ion-item>
            <ion-select label="Tipo de Laudo" labelPlacement="floating"
              okText="Selecionar" cancelText="Fechar"
              interface="action-sheet"
              formControlName="tipoExame"
            >
              <ion-select-option *ngFor="let item of model!.tipos_exame" [value]="item">
                <b>{{item}}</b></ion-select-option>
            </ion-select>
          </ion-item>
        </ion-col>

        <ion-col size-xs="6" size-md="4">
          <ion-item>
            <ion-label position="floating" color="primary">Data da Perícia</ion-label>
            <ion-datetime-button datetime="datetime"></ion-datetime-button>
            <ion-modal [keepContentsMounted]="true">
              <ng-template>
                <ion-datetime id="datetime" formControlName="data" presentation="date"></ion-datetime>
              </ng-template>
            </ion-modal>
          </ion-item>
        </ion-col>

        <ion-col  size-xs="6" size-md="2">
          <ion-item>
            <ion-label position="floating" color="primary">Hora Chegada</ion-label>
            <ion-datetime-button datetime="hora"></ion-datetime-button>
              <ion-modal [keepContentsMounted]="true">
                <ng-template>
                  <ion-datetime id="hora" formControlName="hora" presentation="time"></ion-datetime>
                </ng-template>
              </ion-modal>
          </ion-item>
        </ion-col>

        <ion-col  size-xs="6" size-md="2">
          <ion-item>
            <ion-input label="Protocolo" labelPlacement="floating" placeholder="XXXXX" formControlName="protocolo"></ion-input>
          </ion-item>
        </ion-col>

        <ion-col size-xs="6" size-md="2">
          <ion-item>
            <ion-input label="Ano" labelPlacement="floating" placeholder="XXXX" formControlName="protocoloAno"></ion-input>
          </ion-item>
        </ion-col>

        <ion-col size="12">
          <ion-item>
            <ion-select label="Cidade" labelPlacement="floating"
              okText="Selecionar" cancelText="Fechar"
              interface="action-sheet"
              formControlName="cidade"
            >
              <ion-select-option *ngFor="let item of cidades" [value]="item">
                <b>{{item}}</b></ion-select-option>
            </ion-select>
          </ion-item>
        </ion-col>

        <ion-col  size="12"  *ngIf="form.get('cidade')!.value == 'MANAUS'">
          <ion-item>
            <mat-form-field  style="width:100%">
              <mat-label>Bairro</mat-label>
              <input type="text" 
                  matInput 
                  aria-label="Bairro"
                  formControlName="bairro" 
                  [matAutocomplete]="auto"
                  class="native-input sc-ion-input-md"
              />
            </mat-form-field>
            
            <mat-autocomplete #auto="matAutocomplete">
                <mat-option *ngFor="let option of (bairrosOptions | async)" 
                    [value]="option"  >{{option}}</mat-option>
            </mat-autocomplete> 
                
          </ion-item>
        </ion-col>

        <ion-col  size="12">
          <ion-item>
            <ion-label position="floating" color="primary">Local/Logradouro</ion-label>
            <ion-input placeholder="Endereço ou Local" formControlName="endereco" ></ion-input>
          </ion-item>
        </ion-col>

        <ion-col size="12">
          <ion-item>
            <ion-label position="floating" color="primary">Ponto de Referência</ion-label>
            <ion-input formControlName="pontoref" ></ion-input>
          </ion-item>
        </ion-col>
      </ion-row>
    </ion-grid>
  </form>
</ion-content>

<ion-footer>
  <ion-toolbar>
    <form class="form" [formGroup]="form"  (ngSubmit)="salvar(form.value)">
      <ion-button
        class="submit-btn" type="submit"  color="success" expand="block"
        [disabled]="!form.valid" >Avançar
      </ion-button>
    </form>
  </ion-toolbar>
</ion-footer>
